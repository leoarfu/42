<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, shrink-to-fit=no">
<title>Q2 â€“ Orbital Mechanics & Constellations 101 â€¢ LEOAF</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;800&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
<style>
* { box-sizing:border-box; margin:0; padding:0; }
body { background:#000; color:#f0f0f0; font-family:'Inter',sans-serif; line-height:1.65; min-height:100vh; }
#starsCanvas { position:fixed; inset:0; z-index:-1; }

/* Header â€“ solid black */
header {
    background:#000;
    border-bottom:1px solid #ff004f33;
    position:sticky; top:0; z-index:100;
    padding:1rem clamp(1.5rem,5vw,4rem);
    display:flex; justify-content:space-between; align-items:center;
    box-shadow:0 4px 16px #0008;
}
.nav-left { display:flex; align-items:center; gap:2rem; }
.logo { font-family:'Orbitron',sans-serif; font-size:clamp(1.4rem,4vw,2rem); font-weight:800; letter-spacing:3px; text-decoration:none; }
.logo span:first-child { color:#fff; }
.logo span:last-child { color:#ff004f; }
.back-dashboard { color:#00d9ff; font-size:0.95rem; text-decoration:none; }
.back-dashboard:hover { color:#39ff14; text-decoration:underline; }
.logoff-btn {
    background:transparent; border:1px solid #ff004f; color:#ff004f;
    padding:0.5rem 1rem; font-size:0.85rem; cursor:pointer; border-radius:4px;
}
.logoff-btn:hover { background:#ff004f; color:#000; }

/* Content */
.content { max-width:960px; margin:0 auto; padding:clamp(100px,12vh,140px) 1.5rem 4rem; }
h1 { font-family:'Orbitron',sans-serif; font-size:clamp(2.2rem,6vw,3.6rem); text-align:center; margin-bottom:1.5rem; letter-spacing:1px; color:#00d9ff; }

/* Quarter visual status */
.check-container {
    position:absolute; top:clamp(110px,13vh,150px); right:1.5rem;
    display:flex; align-items:center; gap:0.8rem; pointer-events:none;
}
.check-label { font-size:0.95rem; color:#aaa; }
.custom-checkbox {
    width:32px; height:32px; border:2px solid #ff004f; border-radius:6px;
    display:flex; align-items:center; justify-content:center; background:transparent;
}
.custom-checkbox.checked { border-color:#39ff14; background:rgba(57,255,20,0.25); }
.custom-checkbox.checked::after { content:'ğŸš€'; font-size:1.2rem; }

/* Cards */
.section-card {
    background:rgba(255,255,255,0.025); border:1px solid rgba(0,217,255,0.15);
    border-radius:12px; padding:2rem; margin:2.5rem 0; box-shadow:0 4px 20px #0008;
}
.section-card h2 { font-family:'Orbitron',sans-serif; color:#00d9ff; font-size:1.55rem; margin-bottom:1.2rem; }

/* Accordions */
.accordion-header {
    background:rgba(0,217,255,0.06); padding:1.1rem 1.4rem; border-radius:8px;
    margin:1rem 0; cursor:pointer; display:flex; align-items:center; gap:1rem;
    transition:all 0.2s ease;
}
.accordion-header:hover { background:rgba(0,217,255,0.12); transform:translateX(6px); }
.accordion-header.active { background:rgba(57,255,20,0.12); }
.accordion-header .check-small { width:26px; height:26px; flex-shrink:0; pointer-events:none; }
.custom-checkbox-small {
    width:22px; height:22px; border:2px solid #888; border-radius:4px;
    display:flex; align-items:center; justify-content:center;
}
.custom-checkbox-small.checked { border-color:#39ff14; background:rgba(57,255,20,0.25); }
.custom-checkbox-small.checked::after { content:'âœ“'; color:#39ff14; font-weight:bold; }
.accordion-header h3 { margin:0; font-size:1.15rem; flex:1; }

.accordion-content {
    display:none; padding:1.8rem 1.6rem 2.2rem; background:rgba(0,0,0,0.35);
    border-radius:0 0 8px 8px; border:1px solid rgba(57,255,20,0.2); margin-top:-8px;
}
.close-accordion {
    display: block;
    margin: 1.8rem auto 0.5rem;
    padding: 0.5rem 1.2rem;
    background: rgba(255,255,255,0.06);
    border: 1px solid rgba(255,255,255,0.12);
    border-radius: 6px;
    color: #aaa;
    cursor: pointer;
    font-size: 0.82rem;          /* smaller */
    text-align: center;
    width: fit-content;
    transition: all 0.2s;
}
.close-accordion:hover {
    background: rgba(255,255,255,0.12);
    color: #fff;
}

/* Other styles */
.equation { font-family:monospace; background:#111; padding:1.2rem; border-radius:8px; margin:1.2rem 0; color:#00d9ff; line-height:1.4; }
.code-snippet { background:#0a0a0a; padding:1.4rem; border-radius:8px; font-family:monospace; font-size:0.93rem; overflow-x:auto; margin:1.5rem 0; border-left:4px solid #39ff14; position:relative; }
.takeaway { background:rgba(57,255,20,0.08); border-left:4px solid #39ff14; padding:1.2rem; border-radius:6px; margin:1.5rem 0; font-style:italic; }
.mark-done-btn { margin-top:1.8rem; padding:0.75rem 1.6rem; background:rgba(57,255,20,0.2); border:none; border-radius:6px; color:#fff; cursor:pointer; min-width:220px; text-align:center; }
.mark-done-btn.checked { background:rgba(57,255,20,0.45); }
.mission-note { text-align:center; margin:6rem 0 3rem; font-size:1.05rem; color:#00d9ff88; font-style:italic; }
</style>
</head>
<body>

<canvas id="starsCanvas"></canvas>

<header>
    <div class="nav-left">
        <a href="dashboard.html" class="logo"><span>LEO</span><span>AF</span></a>
        <a href="dashboard.html" class="back-dashboard">â† Mission Dashboard</a>
    </div>
    <button id="logoffBtn" class="logoff-btn">ABORT</button>
</header>

<div class="content">

    <h1>Q2 â€“ Orbital Mechanics & Constellations 101</h1>

    <div class="check-container" id="quarterCheck">
        <div class="check-wrapper"><div class="custom-checkbox"></div></div>
        <span class="check-label">MARK QUARTER COMPLETE</span>
    </div>

    <div class="section-card">
        <h2>ğŸ¯ What you'll master this quarter</h2>
        <p>GEO sits still. LEO screams around Earth ~15Ã— a day. This quarter turns fast motion from â€œscaryâ€ to â€œI get itâ€ â€” with real simulations.</p>
    </div>

    <div class="section-card">
        <h2>Core Topics â€“ click any header to expand ğŸš€</h2>

        <!-- Section 1 -->
        <div class="accordion-header" data-target="topic1">
            <div class="check-small" data-id="q2_topic1"><div class="custom-checkbox-small"></div></div>
            <h3>1. Newtonâ€™s law of gravitation & centripetal force balance</h3>
        </div>
        <div id="topic1" class="accordion-content">
            <h4>Why this section exists</h4>
            <p>This is ground zero for understanding orbits. Every LEO challenge (handovers every 5â€“10 min, huge constellations, strong Doppler, short passes) comes from satellites moving very fast. This equation explains why.</p>

            <h4>The physics â€“ coffee cup vs satellite</h4>
            <p>Gravity pulls the satellite toward Earthâ€™s center. Its forward speed wants to fly it straight into space. Perfect balance â†’ stable circular orbit.</p>

            <div class="equation">
                Gravitational force = Centripetal force<br>
                G Ã— M_earth Ã— m / rÂ²  =  m Ã— vÂ² / r
            </div>

            <p>Satellite mass (m) cancels â†’ orbital velocity:</p>
            <div class="equation">v = âˆš(G M_earth / r)</div>

            <h4>Real numbers â€“ LEO vs GEO</h4>
            <table style="width:100%; margin:1.5rem 0; background:#111; border-radius:8px; overflow:hidden; font-size:0.95rem;">
                <tr style="background:#1a1a1a;"><th style="padding:12px;">Orbit</th><th>Altitude</th><th>Speed</th><th>Period</th><th>Orbits/day</th></tr>
                <tr><td style="padding:12px;">Starlink LEO</td><td>~550 km</td><td>7.67 km/s</td><td>95.6 min</td><td>15.1</td></tr>
                <tr><td style="padding:12px;">ISS</td><td>~400 km</td><td>7.66 km/s</td><td>92.7 min</td><td>15.5</td></tr>
                <tr><td style="padding:12px;">GEO</td><td>35,786 km</td><td>3.07 km/s</td><td>24 h</td><td>1</td></tr>
            </table>

            <h4>Real-life translation</h4>
            <ul>
                <li>LEO satellite circles Earth ~15Ã— per day â†’ disappears over horizon in minutes.</li>
                <li>Aircraft terminal must switch satellites constantly â†’ phased arrays & predictive handovers required.</li>
                <li>GEO stays fixed â†’ no handovers, but ~600 ms latency (bad for real-time apps).</li>
                <li>LEO ~20â€“40 ms latency â†’ huge win for aviation, but needs thousands of satellites.</li>
            </ul>

            <div class="takeaway">
                <strong>One-sentence takeaway:</strong> Lower altitude = dramatically faster satellites = many more needed for continuous coverage. That explains Starlink's ~9,800 satellites vs 3â€“5 GEO satellites.
            </div>

            <h4>Try it yourself â€“ copy-paste & run</h4>
            <div class="code-snippet">
<pre><code class="language-python">
import math

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#   Orbital Velocity Calculator
#   Computes circular orbital speed for any altitude
#   Based on Newton's law of gravitation = centripetal force
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Universal gravitational constant (mÂ³ kgâ»Â¹ sâ»Â²)
G = 6.67430e-11

# Mass of Earth (kg) â€“ standard value used by NASA/ESA
M_earth = 5.972e24

# Mean radius of Earth (meters) â€“ volumetric mean radius
R_earth = 6371000

def orbital_velocity(altitude_km):
    """
    Calculate circular orbital velocity at given altitude above Earth's surface.
    
    Parameters:
        altitude_km (float): Altitude in kilometers above Earth's surface
        
    Returns:
        float: Orbital speed in km/s
    """
    # Distance from center of Earth to satellite (meters)
    r = R_earth + altitude_km * 1000
    
    # Orbital speed in meters per second
    # v = sqrt(G M / r)
    v_ms = math.sqrt(G * M_earth / r)
    
    # Convert to km/s
    return v_ms / 1000


# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#   Example calculations â€“ typical real-world altitudes
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Starlink / modern LEO altitude (~550 km)
leo_speed = orbital_velocity(550)
print(f"550 km LEO speed  : {round(leo_speed, 2)} km/s")

# Classic GEO altitude
geo_speed = orbital_velocity(35786)
print(f"GEO speed         : {round(geo_speed, 2)} km/s")


# Bonus: Try other altitudes yourself!
# Example: Medium Earth Orbit (like GPS ~20,200 km)
meo_speed = orbital_velocity(20200)
print(f"20,200 km MEO speed: {round(meo_speed, 2)} km/s")
</code></pre>
            </div>

            <p><strong>How to run it (3 easy ways):</strong></p>
            <ol style="margin-left:1.5rem; color:#ccc;">
                <li><strong>Fastest:</strong> <a href="https://replit.com/languages/python3" target="_blank" style="color:#00d9ff;">replit.com</a> â†’ paste â†’ Run</li>
                <li><strong>Best for learning:</strong> <a href="https://colab.research.google.com" target="_blank" style="color:#00d9ff;">colab.research.google.com</a> â†’ New notebook â†’ paste â†’ Shift+Enter</li>
                <li><strong>Local:</strong> Save as orbit_speed.py â†’ python orbit_speed.py</li>
            </ol>

            <button class="mark-done-btn" data-id="q2_topic1">Mark as complete</button>

            <button class="close-accordion" onclick="closeAccordion('topic1')">Collapse â†‘</button>
            <!-- <a href="#" class="close-accordion" onclick="document.getElementById('topic1').style.display='none'; document.querySelector('[data-target=\"topic1\"]').classList.remove('active'); return false;">Collapse â†‘</a>-->
        </div>

        <!-- Other topics (placeholders with collapse link) -->
        <div class="accordion-header" data-target="topic2">
            <div class="check-small" data-id="q2_topic2"><div class="custom-checkbox-small"></div></div>
            <h3>2. Keplerâ€™s third law â€“ orbital period vs altitude</h3>
        </div>
<div id="topic2" class="accordion-content">
    <h4>Why this section exists</h4>
    <p>Newton gave us the "how fast" part (velocity). Keplerâ€™s third law gives us the "how long" part â€” how long it takes a satellite to complete one full orbit around Earth. This is the single most important number for understanding why LEO satellites are constantly moving, why handovers happen so often, and why mega-constellations are necessary.</p>

    <h4>The law â€“ simple version</h4>
    <p>Keplerâ€™s third law says: The square of the orbital period is proportional to the cube of the semi-major axis (distance from center).</p>
    <div class="equation">
        TÂ² âˆ aÂ³<br>
        â†’ T = 2Ï€ âˆš(aÂ³ / Î¼)
    </div>
    <p>Where:</p>
    <ul style="margin-left:1.5rem; color:#ddd;">
        <li>T = orbital period (seconds)</li>
        <li>a = semi-major axis = r (for circular orbits) = Earth radius + altitude</li>
        <li>Î¼ = G Ã— M_earth â‰ˆ 3.986 Ã— 10Â¹â´ mÂ³/sÂ² (standard gravitational parameter for Earth)</li>
    </ul>

    <h4>Real numbers â€“ how period changes with altitude</h4>
    <table style="width:100%; margin:1.5rem 0; background:#111; border-radius:8px; overflow:hidden; font-size:0.95rem;">
        <tr style="background:#1a1a1a;"><th style="padding:12px;">Orbit Type</th><th>Altitude</th><th>Period</th><th>Orbits per day</th><th>Why it matters for LEO</th></tr>
        <tr><td style="padding:12px;">Low LEO (ISS)</td><td>~400 km</td><td>~92.7 min</td><td>~15.5</td><td>Very fast â€“ many passes, but short visibility windows</td></tr>
        <tr><td style="padding:12px;">Typical Starlink LEO</td><td>~550 km</td><td>~95.6 min</td><td>~15.1</td><td>Balance of coverage & launch cost â€“ current sweet spot</td></tr>
        <tr><td style="padding:12px;">Higher LEO</td><td>~1,200 km</td><td>~109 min</td><td>~13.2</td><td>Longer passes, but more radiation & harder to de-orbit</td></tr>
        <tr><td style="padding:12px;">MEO (GPS)</td><td>~20,200 km</td><td>~12 hours</td><td>~2</td><td>Far fewer satellites needed, but higher latency</td></tr>
        <tr><td style="padding:12px;">GEO</td><td>35,786 km</td><td>24 h (sidereal)</td><td>1</td><td>Stationary in sky â€“ no handovers, but ~600 ms latency</td></tr>
    </table>

    <h4>What this means in real life (especially for aviation)</h4>
    <ul>
        <li>A Starlink satellite at 550 km completes an orbit every ~96 minutes â†’ it circles Earth ~15 times per day.</li>
        <li>From any fixed point on the ground (or moving plane), you only see it for 4â€“12 minutes per pass before it disappears over the horizon.</li>
        <li>That means your aircraft terminal has to hand over to a new satellite roughly every 5â€“10 minutes â†’ constant beam steering & network rerouting required.</li>
        <li>GEO satellites match Earthâ€™s rotation â†’ they appear fixed in the sky â†’ one handover never needed, but the signal takes ~0.24 seconds each way (total ~600 ms round-trip) â†’ terrible for voice, video, real-time control.</li>
        <li>LEOâ€™s short period is why Starlink can deliver low latency (~20â€“40 ms) â€” but only if you have enough satellites overhead at all times.</li>
    </ul>

    <div class="takeaway">
        <strong>One-sentence takeaway:</strong> The higher you go, the slower the orbit â€” thatâ€™s why LEO needs ~15 orbits per day (and thousands of satellites) while GEO only needs 1 (and a handful of satellites).
    </div>

    <h4>Try it yourself â€“ copy-paste & run</h4>
    <div class="code-snippet">
<pre><code class="language-python">
import math

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#   Kepler's Third Law â€“ Orbital Period Calculator
#   How long does it take to complete one full orbit?
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Gravitational parameter for Earth (mÂ³/sÂ²) â€“ standard value
MU_EARTH = 3.986004418e14

# Earth radius (mean, meters)
R_EARTH = 6371000

def orbital_period(altitude_km):
    """
    Calculate orbital period using Kepler's third law.
    
    Parameters:
        altitude_km (float): Altitude above Earth's surface in km
        
    Returns:
        float: Orbital period in minutes
    """
    # Semi-major axis (for circular orbit) in meters
    a = R_EARTH + altitude_km * 1000
    
    # Period in seconds: T = 2Ï€ âˆš(aÂ³ / Î¼)
    period_sec = 2 * math.pi * math.sqrt(a**3 / MU_EARTH)
    
    # Convert to minutes
    return period_sec / 60


# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#   Real-world examples
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

altitudes = [400, 550, 1200, 20200, 35786]  # ISS, Starlink, high LEO, GPS MEO, GEO
names = ["ISS (400 km)", "Starlink (550 km)", "High LEO (1200 km)", "GPS MEO (20,200 km)", "GEO (35,786 km)"]

for name, alt in zip(names, altitudes):
    period_min = orbital_period(alt)
    orbits_per_day = 1440 / period_min  # 1440 minutes in a day
    print(f"{name:20} â†’ period: {period_min:6.1f} min  |  orbits/day: {orbits_per_day:5.1f}")
</code></pre>
    </div>

    <p><strong>Expected output:</strong></p>
    <div style="background:#111; padding:1rem; border-radius:6px; margin:1rem 0; font-family:monospace; color:#0f0;">
ISS (400 km)         â†’ period:   92.7 min  |  orbits/day:  15.5<br>
Starlink (550 km)    â†’ period:   95.6 min  |  orbits/day:  15.1<br>
High LEO (1200 km)   â†’ period:  109.4 min  |  orbits/day:  13.2<br>
GPS MEO (20,200 km)  â†’ period:  717.7 min  |  orbits/day:   2.0<br>
GEO (35,786 km)      â†’ period: 1440.0 min  |  orbits/day:   1.0
    </div>

    <p><strong>How to run it:</strong> Paste into <a href="https://replit.com/languages/python3" target="_blank" style="color:#00d9ff;">replit.com</a> or <a href="https://colab.research.google.com" target="_blank" style="color:#00d9ff;">Google Colab</a> â†’ Run. Change altitudes and watch how period grows dramatically with height.</p>

    <button class="mark-done-btn" data-id="q2_topic2">Mark as complete</button>

         <button class="close-accordion" onclick="closeAccordion('topic2')">Collapse â†‘</button>
    <!--<a href="#" class="close-accordion" onclick="document.getElementById('topic2').style.display='none'; document.querySelector('[data-target=\"topic2\"]').classList.remove('active'); return false;">Collapse â†‘</a>-->
</div>

        <div class="accordion-header" data-target="topic3">
            <div class="check-small" data-id="q2_topic3"><div class="custom-checkbox-small"></div></div>
            <h3>3. Satellite visibility cone & pass duration</h3>
        </div>
        <div id="topic3" class="accordion-content">
            <p>Coming soon â€“ expand me the same way as topic 1 ğŸŒŒ</p>
            <button class="close-accordion" onclick="closeAccordion('topic3')">Collapse â†‘</button>
        </div>

        <div class="accordion-header" data-target="topic4">
            <div class="check-small" data-id="q2_topic4"><div class="custom-checkbox-small"></div></div>
            <h3>4. LEO ground tracks & nodal precession (Jâ‚‚ effect)</h3>
        </div>
        <div id="topic4" class="accordion-content">
            <p>Coming soon â€“ expand me the same way as topic 1 ğŸŒŒ</p>
            <button class="close-accordion" onclick="closeAccordion('topic4')">Collapse â†‘</button>
        </div>

        <div class="accordion-header" data-target="topic5">
            <div class="check-small" data-id="q2_topic5"><div class="custom-checkbox-small"></div></div>
            <h3>5. Visibility, passes & handover frequency</h3>
        </div>
        <div id="topic5" class="accordion-content">
            <p>Coming soon â€“ expand me the same way as topic 1 ğŸŒŒ</p>
            <button class="close-accordion" onclick="closeAccordion('topic5')">Collapse â†‘</button>
        </div>

        <div class="accordion-header" data-target="topic6">
            <div class="check-small" data-id="q2_topic6"><div class="custom-checkbox-small"></div></div>
            <h3>6. Constellation fundamentals (Walker patterns, streets-of-coverage)</h3>
        </div>
        <div id="topic6" class="accordion-content">
            <p>Coming soon â€“ expand me the same way as topic 1 ğŸŒŒ</p>
            <button class="close-accordion" onclick="closeAccordion('topic6')">Collapse â†‘</button>
        </div>

        <div class="accordion-header" data-target="topic7">
            <div class="check-small" data-id="q2_topic7"><div class="custom-checkbox-small"></div></div>
            <h3>7. Tools & data sources (SGP4, TLEs, Celestrak, Skyfield, Poliastro)</h3>
        </div>
        <div id="topic7" class="accordion-content">
            <p>Coming soon â€“ expand me the same way as topic 1 ğŸŒŒ</p>
            <button class="close-accordion" onclick="closeAccordion('topic7')">Collapse â†‘</button>
        </div>

    </div>

    <div class="section-card">
        <h2>ğŸ“š Best free resources</h2>
        <ul>
            <li>MIT OCW â€“ Aerospace orbital mechanics lectures</li>
            <li>YouTube â€“ Prof. Shane Ross Orbital Mechanics playlist</li>
            <li>Fundamentals of Astrodynamics (free PDF excerpts, Ch 1â€“4)</li>
            <li>Poliastro & Skyfield Python tutorials</li>
            <li>NASA GMAT â€“ free tool + beginner guides</li>
        </ul>
    </div>

    <div class="section-card">
        <h2>ğŸ› ï¸ Hands-on this quarter</h2>
        <ul>
            <li>Ground-track plot of a real satellite</li>
            <li>Visibility passes over Toulouse for 1 week</li>
            <li>LEO vs GEO velocity & period comparison</li>
            <li>GitHub folder: /q2-orbital-mechanics</li>
        </ul>
    </div>

    <div class="mission-note">
        Motion is the biggest difference between GEO and LEO.<br>
        Nail it here â†’ command constellations later. ğŸŒŒ
    </div>

</div>

<script>
// Quarter visual status
const quarterCheck = document.getElementById('quarterCheck');
const quarterId = 'q2-orbital-mechanics';

function updateQuarterVisual() {
    const total = document.querySelectorAll('.check-small').length;
    const checked = document.querySelectorAll('.custom-checkbox-small.checked').length;
    if (checked === total && total > 0) {
        quarterCheck.querySelector('.custom-checkbox').classList.add('checked');
        localStorage.setItem(`leoaf_${quarterId}`, 'true');
    } else {
        quarterCheck.querySelector('.custom-checkbox').classList.remove('checked');
        localStorage.removeItem(`leoaf_${quarterId}`);
    }
}

// Accordion toggle
document.querySelectorAll('.accordion-header').forEach(header => {
    header.addEventListener('click', e => {
        if (e.target.closest('.check-small')) return;
        const target = document.getElementById(header.dataset.target);
        const isOpen = target.style.display === 'block';
        target.style.display = isOpen ? 'none' : 'block';
        header.classList.toggle('active', !isOpen);
    });
});

// Toggle completion from inside button + update text
document.querySelectorAll('.mark-done-btn').forEach(btn => {
    const id = btn.dataset.id;
    const header = btn.closest('.accordion-content').previousElementSibling;
    const cb = header.querySelector('.custom-checkbox-small');

    // Initial text based on saved state
    if (localStorage.getItem(`leoaf_${id}`) === 'true') {
        btn.textContent = 'Unmark / revisit';
        cb?.classList.add('checked');
    } else {
        btn.textContent = 'Mark as complete';
        cb?.classList.remove('checked');
    }

    btn.addEventListener('click', () => {
        const isChecked = cb.classList.toggle('checked');
        btn.textContent = isChecked ? 'Unmark / revisit' : 'Mark as complete';
        localStorage.setItem(`leoaf_${id}`, isChecked);
        updateQuarterVisual();
    });
});

// Restore saved states
document.querySelectorAll('.check-small').forEach(el => {
    const id = el.dataset.id;
    if (localStorage.getItem(`leoaf_${id}`) === 'true') {
        el.querySelector('.custom-checkbox-small')?.classList.add('checked');
    }
});
updateQuarterVisual();

function closeAccordion(targetId) {
    const content = document.getElementById(targetId);
    const header = content.previousElementSibling;
    
    // Hide content
    content.style.display = 'none';
    header.classList.remove('active');
    
    // Smoothly scroll to the header (so user doesn't stay at bottom)
    header.scrollIntoView({ 
        behavior: 'smooth', 
        block: 'start'      // align to top of viewport
    });
}
    
// Optional stars
const canvas = document.getElementById('starsCanvas');
if (canvas) {
    const ctx = canvas.getContext('2d');
    let stars = [];
    function init(){ canvas.width = window.innerWidth; canvas.height = window.innerHeight; stars = []; for(let i=0;i<300;i++) stars.push({x:Math.random()*canvas.width, y:Math.random()*canvas.height, size:Math.random()*1.2+0.3, speed:Math.random()*0.4+0.1}); }
    function animate(){ ctx.fillStyle='rgba(0,0,0,0.12)'; ctx.fillRect(0,0,canvas.width,canvas.height); stars.forEach(s=>{ s.y += s.speed; if(s.y>canvas.height) s.y=0; ctx.fillStyle='#fff'; ctx.fillRect(s.x,s.y,s.size,s.size); }); requestAnimationFrame(animate); }
    init(); animate(); window.addEventListener('resize', init);
}
</script>
    
<!-- 1. Supabase CDN -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<!-- 2. Init + Auth + Progress Logic -->
<script>
const supabaseUrl = 'https://kpkpptqtuuhnbdntuluc.supabase.co';
const supabaseKey = 'sb_publishable_aws8RQ085UqKFBUWfojluQ_o9R9WKBb';
const { createClient } = supabase;
const client = createClient(supabaseUrl, supabaseKey);

document.getElementById('logoffBtn').addEventListener('click', async () => {
    await client.auth.signOut();
    window.location.href = "index.html";
});

document.querySelectorAll('.accordion-header').forEach(header => {
    header.addEventListener('click', e => {
        if (e.target.closest('.check-small')) return;
        const target = document.getElementById(header.dataset.target);
        const isOpen = target.style.display === 'block';
        target.style.display = isOpen ? 'none' : 'block';
        header.classList.toggle('active', !isOpen);
    });
});

function closeAccordion(targetId) {
    const content = document.getElementById(targetId);
    const header = content.previousElementSibling;
    content.style.display = 'none';
    header.classList.remove('active');
    header.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

async function updateQuarterVisual() {
    const total = document.querySelectorAll('.check-small').length;
    const checked = document.querySelectorAll('.custom-checkbox-small.checked').length;
    const quarterCb = document.querySelector('#quarterCheck .custom-checkbox');
    if (!quarterCb) return;
    if (checked === total && total > 0) {
        quarterCb.classList.add('checked');
        await upsertSection('q2-orbital-mechanics', true);
    } else {
        quarterCb.classList.remove('checked');
        await upsertSection('q2-orbital-mechanics', false);
    }
}

async function loadProgress() {
    const mastered = await getMasteredSections();
    document.querySelectorAll('.check-small').forEach(el => {
        const id = el.dataset.id;
        if (mastered.includes(id)) {
            el.querySelector('.custom-checkbox-small')?.classList.add('checked');
        }
    });
    document.querySelectorAll('.mark-done-btn').forEach(btn => {
        const id = btn.dataset.id;
        const header = btn.closest('.accordion-content').previousElementSibling;
        const cb = header.querySelector('.custom-checkbox-small');
        if (mastered.includes(id)) {
            btn.textContent = 'Unmark / revisit';
            cb?.classList.add('checked');
        } else {
            btn.textContent = 'Mark as complete';
        }
    });
    updateQuarterVisual();
}

document.querySelectorAll('.mark-done-btn').forEach(btn => {
    btn.addEventListener('click', async () => {
        const id = btn.dataset.id;
        const header = btn.closest('.accordion-content').previousElementSibling;
        const cb = header.querySelector('.custom-checkbox-small');
        const isChecked = cb.classList.toggle('checked');
        btn.textContent = isChecked ? 'Unmark / revisit' : 'Mark as complete';
        await upsertSection(id, isChecked);
        updateQuarterVisual();
    });
});

document.addEventListener('DOMContentLoaded', async () => {
    const { data: { session } } = await client.auth.getSession();
    if (!session) { window.location.href = "index.html"; return; }
    await loadProgress();
});

const canvas = document.getElementById('starsCanvas');
if (canvas) {
    const ctx = canvas.getContext('2d');
    let stars = [];
    function init(){ canvas.width=window.innerWidth; canvas.height=window.innerHeight; stars=[]; for(let i=0;i<300;i++) stars.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,size:Math.random()*1.2+0.3,speed:Math.random()*0.4+0.1}); }
    function animate(){ ctx.fillStyle='rgba(0,0,0,0.12)'; ctx.fillRect(0,0,canvas.width,canvas.height); stars.forEach(s=>{ s.y+=s.speed; if(s.y>canvas.height) s.y=0; ctx.fillStyle='#fff'; ctx.fillRect(s.x,s.y,s.size,s.size); }); requestAnimationFrame(animate); }
    init(); animate(); window.addEventListener('resize',init);
}
</script>

<!-- 3. User Progress Functions (must be last) -->
<script src="user_progress.js"></script>
</body>
</html>
