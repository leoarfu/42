<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, shrink-to-fit=no">
<title>Command Center — LEOAF</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;800&family=Inter:wght@400;600&display=swap" rel="stylesheet">

<style>
* { box-sizing: border-box; margin:0; padding:0; }

html { height: 100%;
      -webkit-text-size-adjust: 100%;
      max-width: 100vw;
      overflow-x: hidden;
}
    
body {
    font-family: 'Orbitron', sans-serif;
    background: #000;
    color: white;
    overflow-x: hidden;
    max-width: 100vw;
    position: relative;
    min-height: 100vh; 
}

#starsCanvas {
    position: fixed; top:0; left:0; width:100%; height:100%; z-index:-1;
}

/* ---------- HEADER ---------- */
header {
    display: flex; justify-content: space-between; align-items: center;
    padding: 18px clamp(20px, 5vw, 60px);
    border-bottom: 1px solid rgba(255, 0, 79, 0.3);
    background: rgba(0, 0, 0, 0.7); backdrop-filter: blur(5px);
    position: sticky; top: 0; z-index: 10;
}

.logo {
    font-weight: 800; font-size: clamp(18px, 2vw, 24px);
    letter-spacing: 3px; text-decoration: none;
}

.logo span:first-child { color: white; }
.logo span:last-child { color: #ff004f; }

.header-controls { display: flex; align-items: center; gap: 15px; }

.user-id {
    font-size: 10px; color: #00d9ff; letter-spacing: 1px;
    opacity: 0.8; display: none;
}

.logoff-btn {
    background: transparent; border: 1px solid #ff004f; color: #ff004f;
    padding: 6px 14px; cursor: pointer; transition: 0.3s ease;
    font-size: 11px; font-family: 'Orbitron', sans-serif; letter-spacing: 1px;
}

.logoff-btn:hover { background: #ff004f; color: black; box-shadow: 0 0 10px #ff004f; }

/* ---------- DASHBOARD CONTAINER ---------- */
.dashboard {
    width: 100%;
    max-width: 900px;
    margin: 40px auto;
    padding: 0 15px;
    box-sizing: border-box;
    position: relative; z-index: 1;
}

.welcome-msg {
    font-size: clamp(22px, 4vw, 32px); margin-bottom: 10px;
    font-weight: 800; letter-spacing: 1px;
}

/* ---------- PROGRESS BAR ---------- */
.mission-control {
    background: rgba(17, 17, 17, 0.8);
    border: 1px solid rgba(0, 217, 255, 0.3);
    padding: 25px; margin-bottom: 40px;
    box-shadow: inset 0 0 20px rgba(0, 217, 255, 0.05);
}

.progress-header {
    display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 15px;
}

.progress-header h2 { font-size: 16px; color: #00d9ff; letter-spacing: 2px; }
.progress-stats { font-size: 14px; color: #39ff14; }

.progress-track {
    width: 100%; height: 12px; background: rgba(255, 255, 255, 0.1);
    border-radius: 6px; overflow: hidden; position: relative;
}

.progress-fill {
    height: 100%; width: 0%; background: linear-gradient(90deg, #00d9ff, #39ff14);
    box-shadow: 0 0 10px rgba(57, 255, 20, 0.5);
    transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
}

/* ---------- CURRICULUM LIST ---------- */
.module-list { display: flex; flex-direction: column; gap: 15px; }

.module-card {
    display: flex; align-items: center;
    background: rgba(255, 255, 255, 0.03); border-left: 3px solid #ff004f;
    padding: 20px; text-decoration: none; color: white;
    transition: 0.3s ease; position: relative;
}

.module-card:hover {
    background: rgba(0, 217, 255, 0.08); transform: translateX(4px);
    border-left-color: #00d9ff;
}

.module-info { flex-grow: 1; margin-left: 20px; }
.module-info h3 { margin: 0 0 8px; font-size: 18px; color: #ffffff; letter-spacing: 1px; }
.module-info p { margin: 0; font-size: 14px; color: #aaaaaa; font-family: 'Inter', sans-serif; line-height: 1.5; }

/* ---------- CHECKBOX STYLING ---------- */
.check-wrapper {
    position: relative; width: 30px; height: 30px;
    display: flex; justify-content: center; align-items: center;
    cursor: pointer; z-index: 2;
}

.custom-checkbox {
    width: 24px; height: 24px; border: 2px solid #ff004f; background: transparent;
    transition: 0.3s ease; display: flex; justify-content: center; align-items: center;
}

.check-wrapper:hover .custom-checkbox { box-shadow: 0 0 10px rgba(255, 0, 79, 0.5); }

/* Completed State Styles */
.module-card.completed {
    border-left-color: #39ff14; background: rgba(57, 255, 20, 0.03); opacity: 0.7;
}

.module-card.completed:hover { opacity: 1; background: rgba(57, 255, 20, 0.08); }

.module-card.completed .custom-checkbox {
    border-color: #39ff14; background: rgba(57, 255, 20, 0.2);
}

.module-card.completed .custom-checkbox::after {
    content: '✔'; color: #39ff14; font-size: 16px; text-shadow: 0 0 5px #39ff14;
}

.module-card.completed .module-info h3 {
    color: #39ff14; text-decoration: line-through; text-decoration-color: rgba(57, 255, 20, 0.5);
}
</style>
</head>
<body>

<canvas id="starsCanvas"></canvas>

<header>
    <a href="dashboard.html" class="logo"><span>LEO</span><span>AF</span></a>
    <div class="header-controls">
        <span id="userEmail" class="user-id">AGENT</span>
        <button id="logoffBtn" class="logoff-btn">ABORT</button>
    </div>
</header>

<main class="dashboard">
    <h1 class="welcome-msg">MISSION DASHBOARD</h1>
    
    <div class="mission-control">
        <div class="progress-header">
            <h2>TRAINING PROGRESS</h2>
            <span class="progress-stats" id="progressText">0%</span>
        </div>
        <div class="progress-track">
            <div class="progress-fill" id="progressFill"></div>
        </div>
    </div>

    <div class="module-list" id="moduleList">
        
        <a href="phase0.html" class="module-card" data-id="phase0">
            <div class="check-wrapper" title="Mark as Completed"><div class="custom-checkbox"></div></div>
            <div class="module-info">
                <h3>Phase 0 — The Briefing</h3>
                <p>Earth's connectivity gaps, terrestrial limits vs satellite reach, and the history of early LEO failures.</p>
            </div>
        </a>

        <a href="phase1.html" class="module-card" data-id="phase1">
            <div class="check-wrapper" title="Mark as Completed"><div class="custom-checkbox"></div></div>
            <div class="module-info">
                <h3>Phase 1 — Astrodynamics & Physics</h3>
                <p>Orbital mechanics, Kepler's laws, telecom basics, Shannon capacity, and RF fundamentals.</p>
            </div>
        </a>

        <a href="phase2.html" class="module-card" data-id="phase2">
            <div class="check-wrapper" title="Mark as Completed"><div class="custom-checkbox"></div></div>
            <div class="module-info">
                <h3>Phase 2 — Hardware & Architecture</h3>
                <p>Spacecraft subsystems, phased-array User Terminals, laser inter-satellite links, and TT&C gateways.</p>
            </div>
        </a>

        <a href="phase3.html" class="module-card" data-id="phase3">
            <div class="check-wrapper" title="Mark as Completed"><div class="custom-checkbox"></div></div>
            <div class="module-info">
                <h3>Phase 3 — Engineering & Simulation Lab</h3>
                <p>Link budgets, Walker constellations, mesh vs bent-pipe routing, and using STK/Python for orbital modeling.</p>
            </div>
        </a>

        <a href="phase4.html" class="module-card" data-id="phase4">
            <div class="check-wrapper" title="Mark as Completed"><div class="custom-checkbox"></div></div>
            <div class="module-info">
                <h3>Phase 4 — Economics & Strategy</h3>
                <p>CapEx/OpEx modeling, ROI, spectrum rights, orbital debris, and competitive analysis against Fiber & 5G.</p>
            </div>
        </a>

        <a href="phase5.html" class="module-card" data-id="phase5">
            <div class="check-wrapper" title="Mark as Completed"><div class="custom-checkbox"></div></div>
            <div class="module-info">
                <h3>Phase 5 — Specialization & Mobility Deep Dive</h3>
                <p>Choose your technical track. Advanced focus on Aviation/Maritime constraints, radomes, and DO-160 limits.</p>
            </div>
        </a>

        <a href="phase6.html" class="module-card" data-id="phase6">
            <div class="check-wrapper" title="Mark as Completed"><div class="custom-checkbox"></div></div>
            <div class="module-info">
                <h3>Phase 6 — Capstone Mission</h3>
                <p>Design a profitable constellation. Compute the math, write the technical memos, and push code to GitHub.</p>
            </div>
        </a>

    </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
// Supabase Auth Logic
const supabaseUrl = 'https://kpkpptqtuuhnbdntuluc.supabase.co';
const supabaseKey = 'sb_publishable_aws8RQ085UqKFBUWfojluQ_o9R9WKBb'; 
const { createClient } = supabase;
const client = createClient(supabaseUrl, supabaseKey);

document.addEventListener('DOMContentLoaded', async () => {
    const { data: { session } } = await client.auth.getSession();
    if (!session) { window.location.href = "index.html"; return; }

    const emailEl = document.getElementById('userEmail');
    if(session.user.email) {
        emailEl.innerText = session.user.email.toUpperCase();
        emailEl.style.display = 'block';
    }
});

document.getElementById('logoffBtn').addEventListener('click', async () => {
    await client.auth.signOut();
    window.location.href = "index.html";
});

// Progress Bar & Checkbox Logic
const modules = document.querySelectorAll('.module-card');
const progressFill = document.getElementById('progressFill');
const progressText = document.getElementById('progressText');

function loadProgress() {
    let completedCount = 0;
    modules.forEach(card => {
        const id = card.getAttribute('data-id');
        if (localStorage.getItem(`leoaf_${id}`) === 'true') {
            card.classList.add('completed');
            completedCount++;
        }
    });
    updateProgressBar(completedCount, modules.length);
}

function updateProgressBar(completed, total) {
    const percentage = Math.round((completed / total) * 100);
    progressFill.style.width = percentage + '%';
    progressText.innerText = `${percentage}% COMPLETE`;
}

modules.forEach(card => {
    const checkWrapper = card.querySelector('.check-wrapper');
    const id = card.getAttribute('data-id');

    checkWrapper.addEventListener('click', (e) => {
        e.preventDefault(); 
        const isNowCompleted = card.classList.toggle('completed');
        localStorage.setItem(`leoaf_${id}`, isNowCompleted);
        const currentCompleted = document.querySelectorAll('.module-card.completed').length;
        updateProgressBar(currentCompleted, modules.length);
    });
});

loadProgress();

// Starfield Canvas 
const canvas = document.getElementById('starsCanvas');
const ctx = canvas.getContext('2d');
let stars = [];
const STAR_COUNT = 200;

function initStars() {
    stars = [];
    for (let i = 0; i < STAR_COUNT; i++) {
        stars.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            size: Math.random() * 1.5 + 0.5,
            speed: Math.random() * 0.2 + 0.05,
            hue: Math.random() * 360
        });
    }
}

function resizeCanvas() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
resizeCanvas(); initStars(); window.addEventListener('resize', resizeCanvas);

function animateStars(){
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    stars.forEach(star => {
        star.y -= star.speed;
        if(star.y < 0) { star.y = canvas.height; star.x = Math.random() * canvas.width; }
        ctx.beginPath();
        ctx.fillStyle = `hsl(${star.hue}, 80%, 80%)`; 
        ctx.arc(star.x, star.y, star.size, 0, Math.PI*2);
        ctx.fill();
    });
    requestAnimationFrame(animateStars);
}
animateStars();

function setViewportHeight() { document.documentElement.style.setProperty('--vh', `${window.innerHeight * 0.01}px`); }
setViewportHeight(); window.addEventListener('resize', setViewportHeight);
</script>
</body>
</html>
